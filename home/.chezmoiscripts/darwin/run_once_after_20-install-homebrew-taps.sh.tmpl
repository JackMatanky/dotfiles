{{- if eq .chezmoi.os "darwin" -}}
#!/usr/bin/env bash
# Install Homebrew taps (skip on existing systems)
set -euo pipefail

{{ template "logging.sh" . }}

# Skip if existing system
[[ -f "$HOME/.config/chezmoi-initial-setup-complete" ]] && exit 0

# Ensure Homebrew is available
if ! command -v brew &>/dev/null; then
    log_error "Homebrew not found"
    exit 1
fi

# Install taps
{{- range .packages.darwin.taps }}
brew tap {{ . | quote }} 2>/dev/null || true
{{- end }}

log_success "Homebrew taps installed"
{{- end }}
