#!/usr/bin/env bash
{{- if .packages.cargo.crates }}
# Update Rust toolchain and packages (skip on existing systems)
set -euo pipefail

{{ template "logging.sh" . }}

# Skip if existing system
[[ -f "$HOME/.config/chezmoi-initial-setup-complete" ]] && exit 0

# Update Rust toolchain if available
if command -v rustup &>/dev/null; then
    rustup update
fi

# Update packages if cargo-update is available
if command -v cargo-install-update &>/dev/null; then
    cargo install-update --all && log_success "Cargo packages updated"
fi
{{- else }}
#!/usr/bin/env bash
# No cargo packages configured
exit 0
{{- end }}
